<!DOCTYPE html>
<html>
<head>
    <title>Recycle Bin - Dug Hill Rod & Gun Club</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='Main_Logo-removebg-preview.png') }}">
<style>
    .active-menu {
        background-color: rgb(255,255,0) !important;
    }
    .submenu {
        display: none;
        flex-direction: column;
        margin-left: 10px;
    }
    .submenu.active {
        display: flex;
    }
    .submenu a {
        width: 160px !important;
        font-size: 0.9em !important;
        padding: 8px 0 !important;
        margin-bottom: 6px !important;
    }
    .menu-toggle {
        cursor: pointer;
        user-select: none;
    }
</style>
</head>
<body style="background-color:#384839; font-family:Arial, Helvetica, sans-serif;">
    <div style="display:flex; flex-direction:row;">
        <!-- Static Side Menu -->
        <div style="position:fixed; top:0; left:0; height:100vh; width:210px; background-color:#2c332b; display:flex; flex-direction:column; align-items:center; padding-top:120px; z-index:100; box-shadow:2px 0 8px rgba(0,0,0,0.08); overflow-y:auto;">
            <img src="{{ url_for('static', filename='Main_Logo-removebg-preview.png') }}" alt="Main Logo" style="height:143px; margin-top:-88px; margin-left:-8px; margin-bottom:34px;">
            <a href="{{ url_for('index') }}" class="{{ 'active-menu' if active_page == 'home' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:{{ 'rgb(255,255,0)' if active_page == 'home' else '#eaeaea' }}; color:#384839; text-decoration:none; font-weight:{{ 'bold' if active_page == 'home' else 'normal' }}; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">üè† Home</a>
            <a href="javascript:void(0);" onclick="openModal('addMemberModal')" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:normal; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">‚ûï Add Member</a>
            <a href="{{ url_for('recycle_bin') }}" class="{{ 'active-menu' if active_page == 'recycle_bin' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:{{ 'bold' if active_page == 'recycle_bin' else 'normal' }}; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">üóëÔ∏è Recycle Bin</a>
            <a href="{{ url_for('bulk_actions') }}" class="{{ 'active-menu' if active_page == 'bulk_actions' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:{{ 'bold' if active_page == 'bulk_actions' else 'normal' }}; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">‚ö° Bulk Actions</a>
            
            <div class="menu-toggle" onclick="toggleSubmenu()" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:normal; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">
                üìä Reports <span id="submenu-arrow">‚ñº</span>
            </div>
            <div id="reports-submenu" class="submenu {% if active_page in ['dues_report', 'work_hours_report', 'meeting_attendance_report', 'kiosk_report'] %}active{% endif %}">
                <a href="{{ url_for('dues_report') }}" class="{{ 'active-menu' if active_page == 'dues_report' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:{{ 'bold' if active_page == 'dues_report' else 'normal' }}; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">üíµ Dues</a>
                <a href="{{ url_for('work_hours_report') }}" class="{{ 'active-menu' if active_page == 'work_hours_report' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:{{ 'bold' if active_page == 'work_hours_report' else 'normal' }}; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">
                    <img src="{{ url_for('static', filename='icon_work_hours.svg') }}" alt="Work Hours" style="height:1em; vertical-align:middle; margin-right:6px;"> Work Hours
                </a>
                <a href="{{ url_for('meeting_attendance_report') }}" class="{{ 'active-menu' if active_page == 'meeting_attendance_report' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:{{ 'bold' if active_page == 'meeting_attendance_report' else 'normal' }}; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">
                    <img src="{{ url_for('static', filename='icon_attendance.svg') }}" alt="Attendance" style="height:1em; vertical-align:middle; margin-right:6px;"> Meeting Attendance
                </a>
                <a href="{{ url_for('kiosk_report') }}" class="{{ 'active-menu' if active_page == 'kiosk_report' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:{{ 'bold' if active_page == 'kiosk_report' else 'normal' }}; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">üü© Check-ins</a>
            </div>
            
            <a href="{{ url_for('committees') }}" class="{{ 'active-menu' if active_page == 'committees' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:{{ 'bold' if active_page == 'committees' else 'normal' }}; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">üë• Committees</a>
            <!-- Email List button removed -->
            <a href="{{ url_for('kiosk') }}" target="_blank" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:normal; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">üñ•Ô∏è Kiosk</a>
            {% if current_user.is_admin_or_bdfl() %}
            <a href="{{ url_for('admin_users') }}" class="{{ 'active-menu' if active_page == 'admin_users' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:{{ '#5bc0de' if active_page != 'admin_users' else 'rgb(255,255,0)' }}; color:{{ '#ffffff' if active_page != 'admin_users' else '#000000' }}; text-decoration:none; font-weight:bold; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center; position:relative;">
                <span style="display: flex; align-items: center; width: 100%; justify-content: center; text-align: center;">
                    <span style="display:inline-block; vertical-align:middle;"><span>üë§</span> <span>Admin</span></span>
                </span>
            </a>
            {% endif %}
            <a href="{{ url_for('logout') }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#d9534f; color:#ffffff; text-decoration:none; font-weight:bold; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">üö™ Logout</a>
            <div style="width:170px; margin-top:20px; padding:10px; border-top:1px solid #384839;">
                <div style="color:#f5f5f5; font-size:0.9em; line-height:1.6; text-align:left;">
                    <div style="margin-bottom:8px;"><strong>Life:</strong> {{ member_stats.life_members }}</div>
                    <div style="margin-bottom:8px;"><strong>Probationary, Associate, & Active:</strong> {{ member_stats.voting_members }}</div>
                    <div style="border-top:1px solid #555; padding-top:8px;"><strong>Total:</strong> {{ member_stats.total_members }}</div>
                </div>
            </div>
        </div>
        <!-- Add Member Modal -->
        <div id="addMemberModal" class="modal" style="display:none; position:fixed; z-index:1000; left:0; top:0; width:100%; height:100%; overflow:auto; background-color:rgba(0,0,0,0.4);">
            <div style="background-color:#f5f5f5; margin:4% auto; padding:20px; border:1px solid #888; width:420px; border-radius:8px; position:relative;">
                <button onclick="closeModal('addMemberModal')" style="position:absolute; top:10px; right:10px; background:none; border:none; font-size:1.5em; color:#384839; cursor:pointer;">&times;</button>
                <h3 style="margin-top:0; text-align:center;">Add Member</h3>
                <form id="addMemberForm">
                    <div style="display:grid; grid-template-columns:120px 1fr; gap:10px 12px; align-items:center;">
                        <label for="badge_number">Badge Number:</label><input type="text" id="badge_number" name="badge_number" required>
                        <label for="membership_type">Membership Type:</label>
                        <select id="membership_type" name="membership_type" required>
                            <option value="Probationary">Probationary</option>
                            <option value="Associate">Associate</option>
                            <option value="Active">Active</option>
                            <option value="Life">Life</option>
                            <option value="Honorary">Honorary</option>
                            <option value="Prospective">Prospective</option>
                            <option value="Wait List">Wait List</option>
                            <option value="Former">Former</option>
                        </select>
                        <label for="first_name">First Name:</label><input type="text" id="first_name" name="first_name" required>
                        <label for="middle_name">Middle Name:</label><input type="text" id="middle_name" name="middle_name">
                        <label for="last_name">Last Name:</label><input type="text" id="last_name" name="last_name" required>
                        <label for="suffix">Suffix:</label><input type="text" id="suffix" name="suffix">
                        <label for="nickname">Nickname:</label><input type="text" id="nickname" name="nickname">
                        <label for="dob">Date of Birth:</label><input type="date" id="dob" name="dob">
                        <label for="email">Primary Email:</label>
                        <div style="display:flex; align-items:center; gap:4px;">
                            <input type="email" id="email" name="email">
                            <button type="button" onclick="copyEmail('email')" title="Copy Email" style="padding:2px 8px; font-size:1em; cursor:pointer;">üìã</button>
                        </div>
                        <label for="email2">Secondary Email:</label>
                        <div style="display:flex; align-items:center; gap:4px;">
                            <input type="email" id="email2" name="email2">
                            <button type="button" onclick="copyEmail('email2')" title="Copy Email" style="padding:2px 8px; font-size:1em; cursor:pointer;">üìã</button>
                        </div>
                        </script>
                        <script>
                        function copyEmail(inputId) {
                            var input = document.getElementById(inputId);
                            if (input) {
                                input.select();
                                input.setSelectionRange(0, 99999); // For mobile
                                document.execCommand('copy');
                                alert('Email copied to clipboard!');
                            }
                        }
                        </script>
                        <label for="phone">Primary Phone:</label><input type="text" id="phone" name="phone">
                        <label for="phone2">Secondary Phone:</label><input type="text" id="phone2" name="phone2">
                        <label for="address">Address:</label><input type="text" id="address" name="address">
                        <label for="city">City:</label><input type="text" id="city" name="city">
                        <label for="state">State:</label><input type="text" id="state" name="state">
                        <label for="zip">Zip Code:</label><input type="text" id="zip" name="zip">
                        <label for="join_date">Join Date:</label><input type="date" id="join_date" name="join_date">
                        <label for="sponsor">Sponsor:</label><input type="text" id="sponsor" name="sponsor">
                        <label for="card_internal">Card/Fob Internal Number:</label><input type="text" id="card_internal" name="card_internal">
                        <label for="card_external">Card/Fob External Number:</label><input type="text" id="card_external" name="card_external">
                    </div>
                    <div style="margin-top:18px; text-align:center;">
                        <button type="submit" style="padding:6px 18px; border-radius:6px; border:1px solid #384839; background:#eaeaea; color:#384839; cursor:pointer;">Add Member</button>
                        <button type="button" onclick="closeModal('addMemberModal')" style="padding:6px 18px; border-radius:6px; border:1px solid #ccc; background:#f8f8f8; color:#333; cursor:pointer; margin-left:8px;">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
        <script>
        function openModal(id) {
            document.getElementById(id).style.display = 'block';
            document.getElementById(id).style.zIndex = 2000;
        }
        function closeModal(id) {
            document.getElementById(id).style.display = 'none';
        }
        document.getElementById('addMemberForm').onsubmit = function(e) {
            e.preventDefault();
            var form = document.getElementById('addMemberForm');
            var formData = new FormData(form);
            fetch('/add_member', {
                method: 'POST',
                body: formData
            }).then(function(resp) {
                if (resp.ok) {
                    location.reload();
                } else {
                    alert('Error adding member');
                }
            });
        };
        </script>
        <!-- Main content area shifted right to accommodate side menu -->
        <div style="flex:1; margin-left:210px; display:flex; flex-direction:column; align-items:center;">
            <div style="display:flex; flex-direction:row; align-items:center; justify-content:center; margin-bottom:20px; width:100%;">
                <div style="text-align:center; width:100%;">
                    <h1 style="margin-bottom:0.2em; color:#f5f5f5; font-size:3em;">Dug Hill Rod & Gun Club</h1>
                    <h1 style="margin-top:0.2em; color:#f5f5f5; font-size:3em;">Membership Database</h1>
                    <h2 style="font-size:2.2em; margin-bottom:0.2em; margin-top:0; text-align:center; color:#f5f5f5; font-family:Arial, Helvetica, sans-serif; font-weight:bold; text-decoration:underline;">Recycle Bin</h2>
                    <!-- Restore All and Permanently Delete All buttons moved to sidebar -->
                </div>
            </div>
            <table border="1" cellpadding="6" cellspacing="0" style="margin:auto; width:100%; max-width:900px; table-layout:fixed; background-color:#f5f5f5;">
            <tr>
                <th style="width:70px;">Badge</th>
                <th style="width:90px;">Type</th>
                <th style="width:110px;">First Name</th>
                <th style="width:110px;">Last Name</th>
                <th style="width:180px;">Email</th>
                <th style="width:110px;">Phone</th>
                <th style="width:110px;">Deleted On</th>
                <th style="width:140px;">Actions</th>
            </tr>
            {% for member in deleted_members %}
            <tr>
                <td style="text-align:center;">{{ member['badge_number'] }}</td>
                <td>{{ member['membership_type'] }}</td>
                <td>{{ member['first_name'] }}</td>
                <td>{{ member['last_name'] }}</td>
                <td>{{ member['email'] }}</td>
                <td>{{ member['phone'] }}</td>
                <td>{{ member['deleted_on']|format_mmddyyyy if 'deleted_on' in member else '' }}</td>
                <td>
                    <form action="{{ url_for('restore_member', member_id=member['id']) }}" method="post" style="display:inline;">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                        <button type="submit" style="width:120px; padding:2px 0; margin-bottom:8px; border-radius:6px; border:1px solid #384839; background:#eaeaea; color:#384839; cursor:pointer; text-align:center; font-size:1em;">Restore</button>
                    </form>
                    <form action="{{ url_for('delete_member_permanently', member_id=member['id']) }}" method="post" style="display:inline; margin-top:6px;">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                        <button type="submit" onclick="return confirm('Are you sure you want to permanently delete this member? This cannot be undone.')" style="width:120px; padding:2px 0; border-radius:6px; border:1px solid #c00; background:#ffeaea; color:#c00; cursor:pointer; text-align:center; font-size:1em;">Delete Permanently</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </table>
    </div>
<!-- Email List button removed -->
<script>
function toggleSubmenu() {
    var submenu = document.getElementById('reports-submenu');
    var arrow = document.getElementById('submenu-arrow');
    submenu.classList.toggle('active');
    arrow.textContent = submenu.classList.contains('active') ? '‚ñ≤' : '‚ñº';
}

function generateEmailList() {
    alert('Email list functionality would be here');
}
</script>
</body>

</html>
