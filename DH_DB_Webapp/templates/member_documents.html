<!DOCTYPE html>
<html>
<head>
    <title>Member Documents - Dug Hill Rod & Gun Club</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='Main_Logo-removebg-preview.png') }}">
    <style>
        body { background-color: #f5f5f5; font-family: Arial, Helvetica, sans-serif; }
        .main-content { margin-left:210px; display:flex; flex-direction:column; align-items:center; }
        .documents-container { width: 100%; max-width: 1250px; margin: 0 auto; box-sizing: border-box; }
        .documents-card { background: white; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); padding: 20px; margin-bottom: 20px; }
        .card-header { border-bottom: 1px solid #ddd; padding-bottom: 10px; margin-bottom: 15px; }
        .card-title { margin: 0; color: #384839; font-size: 1.5em; }
        .document-list { column-count: 2; column-gap: 20px; max-width: 100%; box-sizing: border-box; column-fill: balance; }
        .document-item { background: #f8f8f8; padding: 15px; border-radius: 6px; border: 1px solid #ddd; transition: all 0.2s; break-inside: avoid; page-break-inside: avoid; }
        .document-item:hover { background: #e8f4fd; border-color: #007bff; }
        .document-title { font-weight: bold; color: #333; margin-bottom: 8px; }
        .document-description { color: #666; font-size: 0.9em; margin-bottom: 10px; }
        .document-link { display: inline-block; background: #007bff; color: white; padding: 8px 16px; text-decoration: none; border-radius: 4px; font-size: 0.9em; }
        .document-link:hover { background: #0056b3; }
        .upload-btn { display: inline-block; background: #28a745; color: white; padding: 6px 12px; text-decoration: none; border-radius: 4px; font-size: 0.8em; margin-left: 8px; cursor: pointer; }
        .reorder-btn { background: #6c757d; color: white; border: none; border-radius: 3px; cursor: pointer; }
        .reorder-btn:hover { background: #5a6268; }
        .reorder-btn:disabled { background: #ccc; cursor: not-allowed; }
        .document-actions { margin-top: 10px; }
        .document-actions > * { margin-right: 8px; }
        .document-actions > *:last-child { margin-right: 0; }
        .no-documents { text-align: center; color: #666; font-style: italic; padding: 40px; }
    </style>
</head>
<body style="background-color:#384839; font-family:Arial, Helvetica, sans-serif;">
    <div style="display:flex; flex-direction:row;">
        <!-- Static Side Menu -->
        <div style="position:fixed; top:0; left:0; height:100vh; width:210px; background-color:#2c332b; display:flex; flex-direction:column; align-items:center; padding-top:120px; z-index:100; box-shadow:2px 0 8px rgba(0,0,0,0.08); overflow-y:auto;">
            <img src="{{ url_for('static', filename='Main_Logo-removebg-preview.png') }}" alt="Main Logo" style="height:143px; margin-top:-88px; margin-left:-8px; margin-bottom:34px;">
            <a href="{{ url_for('member_dashboard') }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; {% if active_page == 'dashboard' %}background-color:rgb(255,255,0); color:#384839; font-weight:bold;{% else %}background-color:#eaeaea; color:#384839; font-weight:normal;{% endif %} text-decoration:none; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">üè† Dashboard</a>
            <a href="{{ url_for('member_documents') }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; {% if active_page == 'documents' %}background-color:rgb(255,255,0); color:#384839; font-weight:bold;{% else %}background-color:#eaeaea; color:#384839; font-weight:normal;{% endif %} text-decoration:none; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">üìÑ Documents</a>
            <a href="{{ url_for('member_meeting_minutes') }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; {% if active_page == 'meeting-minutes' %}background-color:rgb(255,255,0); color:#384839; font-weight:bold;{% else %}background-color:#eaeaea; color:#384839; font-weight:normal;{% endif %} text-decoration:none; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">üìù Meeting Minutes</a>
            {% if is_admin %}
            <a href="{{ url_for('admin_dashboard') }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#007bff; color:#ffffff; text-decoration:none; font-weight:bold; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">üè† Admin Home</a>
            {% endif %}
            <a href="{{ url_for('logout') }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#d9534f; color:#ffffff; text-decoration:none; font-weight:bold; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">üö™ Logout</a>
        </div>

        <!-- Main content area -->
        <div class="main-content">
            <div style="display:flex; flex-direction:row; align-items:center; justify-content:center; margin-bottom:20px; width:100%;">
                <div style="text-align:center; width:100%;">
                    <h1 style="margin-bottom:0.2em; color:#f5f5f5; font-size:3em;">Dug Hill Rod & Gun Club</h1>
                    <h1 style="margin-top:0.2em; color:#f5f5f5; font-size:3em;">Member Documents</h1>
                </div>
            </div>

            <div class="documents-container">
                <div class="documents-card">
                    <div class="card-header">
                        <h2 class="card-title">üìÑ Available Documents</h2>
                        {% if is_admin %}
                        <div style="margin-top: 10px;">
                            <button onclick="event.preventDefault(); event.stopPropagation(); openAddDocumentModal()" class="upload-btn" style="background: #28a745;">‚ûï Add New Document</button>
                        </div>
                        {% endif %}
                    </div>

                    <div class="document-list">
                        {% if pdf_files %}
                            {% if is_admin %}
                            <form id="reorderForm" method="post" action="{{ url_for('reorder_documents') }}" onsubmit="return updateOrderBeforeSubmit()">
                                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                            {% endif %}
                            
                            {% for filename in pdf_files %}
                            {% set doc_key = filename.replace('.pdf', '').lower().replace('_', ' ').replace('-', ' ') %}
                            <div class="document-item" {% if is_admin %}data-doc-key="{{ doc_key }}"{% endif %}>
                                {% if is_admin %}
                                <div class="document-reorder-controls" style="float: left; margin-right: 10px;">
                                    <button type="button" onclick="moveDocumentUp(this)" class="reorder-btn" style="display: block; padding: 2px 6px; margin-bottom: 2px; font-size: 12px;">‚Üë</button>
                                    <button type="button" onclick="moveDocumentDown(this)" class="reorder-btn" style="display: block; padding: 2px 6px; font-size: 12px;">‚Üì</button>
                                </div>
                                {% endif %}
                                
                                <div class="document-content" {% if is_admin %}style="margin-left: 40px;"{% endif %}>
                                    <div class="document-title">{{ document_icons[filename] }} {{ document_titles[filename] }}</div>
                                    <div class="document-description">{{ file_descriptions[filename] }}</div>
                                    <div class="document-actions">
                                        {% if is_admin %}
                                        <button onclick="event.preventDefault(); event.stopPropagation(); openEditDescriptionModal('{{ filename }}', '{{ document_titles[filename] }}', '{{ file_descriptions[filename] | replace("'", "\\'") }}')" class="upload-btn" style="background: #17a2b8; padding: 6px 16px;">‚úèÔ∏è Edit</button>
                                        <button onclick="deleteDocument({{ loop.index }})" class="upload-btn" style="background: #dc3545;">üóëÔ∏è Delete</button>
                                        {% endif %}
                                        <a href="{{ url_for('static', filename=filename) }}" class="document-link" target="_blank">{{ document_icons[filename] }} View Document</a>
                                    </div>
                                </div>
                                <div style="clear: both;"></div>
                            </div>
                            {% endfor %}
                            
                            {% if is_admin %}
                            <div style="margin-top: 20px; text-align: center;">
                                <button type="submit" class="upload-btn" style="background: #28a745; padding: 10px 20px; font-size: 16px;">üíæ Save Document Order</button>
                            </div>
                            </form>
                            {% endif %}
                            
                            {% if is_admin %}
                            <!-- Separate forms for delete actions -->
                            {% for filename in pdf_files %}
                            <form method="post" action="{{ url_for('delete_document', filename=filename) }}" style="display: none;" id="delete-form-{{ loop.index }}">
                                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                            </form>
                            {% endfor %}
                            {% endif %}
                        {% else %}
                            <div class="no-documents">
                                <p>No documents are currently available.</p>
                                {% if is_admin %}
                                <p>As an administrator, you can upload documents using the upload functionality.</p>
                                {% endif %}
                            </div>
                        {% endif %}
                    </div>
                </div>

                {% if is_admin %}
                </form>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Add Document Modal -->
    <div id="addDocumentModal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);">
        <div id="addDocumentModalContent" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); width: 90%; max-width: 500px;">
            <h3 style="margin-top: 0; color: #384839;">Add New Document</h3>
            <form method="post" enctype="multipart/form-data" action="{{ url_for('upload_new_document') }}">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                
                <div style="margin-bottom: 15px;">
                    <label for="document_title" style="display: block; margin-bottom: 5px; font-weight: bold;">Document Title:</label>
                    <input type="text" id="document_title" name="title" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label for="document_description" style="display: block; margin-bottom: 5px; font-weight: bold;">Description:</label>
                    <textarea id="document_description" name="description" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; min-height: 80px; resize: vertical; font-family: Arial, sans-serif;"></textarea>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label for="document_file" style="display: block; margin-bottom: 5px; font-weight: bold;">PDF File:</label>
                    <input type="file" id="document_file" name="file" accept=".pdf" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;">
                </div>
                
                <div style="text-align: right;">
                    <button type="button" onclick="closeAddDocumentModal()" style="padding: 8px 16px; background: #6c757d; color: white; border: none; border-radius: 4px; margin-right: 10px; cursor: pointer;">Cancel</button>
                    <button type="submit" style="padding: 8px 16px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">Add Document</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Description Modal -->
    <div id="editDescriptionModal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);">
        <div id="editModalContent" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); width: 90%; max-width: 500px;">
            <h3 style="margin-top: 0; color: #384839;">Edit Document</h3>
            <form method="post" enctype="multipart/form-data" action="" id="editDescriptionForm">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <input type="hidden" id="edit_filename" name="filename" value="">
                
                <div style="margin-bottom: 15px;">
                    <label for="edit_title" style="display: block; margin-bottom: 5px; font-weight: bold;">Document Title:</label>
                    <input type="text" id="edit_title" name="title" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label for="edit_description" style="display: block; margin-bottom: 5px; font-weight: bold;">Description:</label>
                    <textarea id="edit_description" name="description" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; min-height: 80px; resize: vertical; font-family: Arial, sans-serif;"></textarea>
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label for="edit_file" style="display: block; margin-bottom: 5px; font-weight: bold;">Replace PDF File (optional):</label>
                    <input type="file" id="edit_file" name="file" accept=".pdf" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;">
                </div>
                
                <div style="text-align: right;">
                    <button type="button" onclick="closeEditDescriptionModal()" style="padding: 8px 16px; background: #6c757d; color: white; border: none; border-radius: 4px; margin-right: 10px; cursor: pointer;">Cancel</button>
                    <button type="submit" style="padding: 8px 16px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">Update Document</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Meeting Minutes Modal -->
    <div id="addMinutesModal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);">
        <div id="addMinutesModalContent" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); width: 90%; max-width: 600px;">
            <h3 style="margin-top: 0; color: #384839;">Add Meeting Minutes</h3>
            <form method="post" enctype="multipart/form-data" action="{{ url_for('add_meeting_minutes') }}">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                
                <div style="margin-bottom: 15px;">
                    <label for="minutes_title" style="display: block; margin-bottom: 5px; font-weight: bold;">Meeting Title:</label>
                    <input type="text" id="minutes_title" name="title" placeholder="e.g., January 2026 Board Meeting" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label for="minutes_date" style="display: block; margin-bottom: 5px; font-weight: bold;">Meeting Date:</label>
                    <input type="date" id="minutes_date" name="meeting_date" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;">
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label for="minutes_file" style="display: block; margin-bottom: 5px; font-weight: bold;">Attach PDF (optional):</label>
                    <input type="file" id="minutes_file" name="file" accept=".pdf" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;">
                </div>
                
                <div style="text-align: right;">
                    <button type="button" onclick="closeAddMinutesModal()" style="padding: 8px 16px; background: #6c757d; color: white; border: none; border-radius: 4px; margin-right: 10px; cursor: pointer;">Cancel</button>
                    <button type="submit" style="padding: 8px 16px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">Add Minutes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Meeting Minutes Modal -->
    <div id="editMinutesModal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);">
        <div id="editMinutesModalContent" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); width: 90%; max-width: 600px;">
            <h3 style="margin-top: 0; color: #384839;">Edit Meeting Minutes</h3>
            <form method="post" enctype="multipart/form-data" id="editMinutesForm">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <input type="hidden" id="edit_minutes_id" name="minutes_id">
                
                <div style="margin-bottom: 15px;">
                    <label for="edit_minutes_title" style="display: block; margin-bottom: 5px; font-weight: bold;">Meeting Title:</label>
                    <input type="text" id="edit_minutes_title" name="title" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;">
                </div>
                
                <div style="margin-bottom: 15px;">
                    <label for="edit_minutes_date" style="display: block; margin-bottom: 5px; font-weight: bold;">Meeting Date:</label>
                    <input type="date" id="edit_minutes_date" name="meeting_date" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;">
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label for="edit_minutes_file" style="display: block; margin-bottom: 5px; font-weight: bold;">Attach PDF (optional - replaces existing):</label>
                    <input type="file" id="edit_minutes_file" name="pdf_file" accept=".pdf" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;">
                </div>
                
                <div style="text-align: right;">
                    <button type="button" onclick="closeEditMinutesModal()" style="padding: 8px 16px; background: #6c757d; color: white; border: none; border-radius: 4px; margin-right: 10px; cursor: pointer;">Cancel</button>
                    <button type="submit" style="padding: 8px 16px; background: #17a2b8; color: white; border: none; border-radius: 4px; cursor: pointer;">Update Minutes</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Initialize modal event listeners when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Add click listeners to modal backgrounds to close when clicking outside content
            document.getElementById('addDocumentModal').addEventListener('click', function(e) {
                var modalContent = document.getElementById('addDocumentModalContent');
                if (!modalContent.contains(e.target)) {
                    closeAddDocumentModal();
                }
            });
            
            document.getElementById('editDescriptionModal').addEventListener('click', function(e) {
                var modalContent = document.getElementById('editModalContent');
                if (!modalContent.contains(e.target)) {
                    closeEditDescriptionModal();
                }
            });
            
            document.getElementById('addMinutesModal').addEventListener('click', function(e) {
                var modalContent = document.getElementById('addMinutesModalContent');
                if (!modalContent.contains(e.target)) {
                    closeAddMinutesModal();
                }
            });
            
            document.getElementById('editMinutesModal').addEventListener('click', function(e) {
                var modalContent = document.getElementById('editMinutesModalContent');
                if (!modalContent.contains(e.target)) {
                    closeEditMinutesModal();
                }
            });
        });

        function openAddDocumentModal() {
            document.getElementById('addDocumentModal').style.display = 'block';
        }
        
        function closeAddDocumentModal() {
            document.getElementById('addDocumentModal').style.display = 'none';
            // Reset form
            document.getElementById('document_title').value = '';
            document.getElementById('document_description').value = '';
            document.getElementById('document_file').value = '';
        }
        
        function openEditDescriptionModal(filename, currentTitle, currentDescription) {
            document.getElementById('edit_filename').value = filename;
            document.getElementById('edit_title').value = currentTitle;
            document.getElementById('edit_description').value = currentDescription;
            document.getElementById('editDescriptionForm').action = '{{ url_for("update_description", filename="PLACEHOLDER") }}'.replace('PLACEHOLDER', filename);
            document.getElementById('editDescriptionModal').style.display = 'block';
        }
        
        function closeEditDescriptionModal() {
            document.getElementById('editDescriptionModal').style.display = 'none';
            // Reset form
            document.getElementById('edit_filename').value = '';
            document.getElementById('edit_title').value = '';
            document.getElementById('edit_description').value = '';
            document.getElementById('edit_file').value = '';
        }
        
        function deleteDocument(index) {
            if (confirm('Are you sure you want to delete this document?')) {
                document.getElementById('delete-form-' + index).submit();
            }
        }

        // Document reordering functions
        function moveDocumentUp(buttonElement) {
            const documentItem = buttonElement.closest('.document-item');
            const allItems = Array.from(document.querySelectorAll('.document-item[data-doc-key]'));
            const currentIndex = allItems.indexOf(documentItem);
            
            if (currentIndex > 0) {
                const prevItem = allItems[currentIndex - 1];
                documentItem.parentNode.insertBefore(documentItem, prevItem);
                updateButtonStates();
            }
        }

        function moveDocumentDown(buttonElement) {
            const documentItem = buttonElement.closest('.document-item');
            const allItems = Array.from(document.querySelectorAll('.document-item[data-doc-key]'));
            const currentIndex = allItems.indexOf(documentItem);
            
            if (currentIndex < allItems.length - 1) {
                const nextItem = allItems[currentIndex + 1];
                documentItem.parentNode.insertBefore(nextItem, documentItem);
                updateButtonStates();
            }
        }

        function updateButtonStates() {
            const documentItems = document.querySelectorAll('.document-item[data-doc-key]');
            documentItems.forEach((item, index) => {
                const upBtn = item.querySelector('button[onclick*="moveDocumentUp"]');
                const downBtn = item.querySelector('button[onclick*="moveDocumentDown"]');
                
                if (upBtn) upBtn.disabled = (index === 0);
                if (downBtn) downBtn.disabled = (index === documentItems.length - 1);
            });
        }

        function updateOrderBeforeSubmit() {
            // Clear existing inputs
            const existingInputs = document.querySelectorAll('input[name="document_order[]"]');
            existingInputs.forEach(input => input.remove());
            
            // Create new inputs based on current DOM order
            const documentItems = document.querySelectorAll('.document-item[data-doc-key]');
            const form = document.getElementById('reorderForm');
            
            documentItems.forEach((item) => {
                const docKey = item.getAttribute('data-doc-key');
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = 'document_order[]';
                input.value = docKey;
                form.appendChild(input);
            });
            
            return true;
        }

        // Meeting Minutes functions
        function openAddMinutesModal() {
            document.getElementById('addMinutesModal').style.display = 'block';
        }

        function closeAddMinutesModal() {
            document.getElementById('addMinutesModal').style.display = 'none';
            // Reset form
            document.getElementById('minutes_title').value = '';
            document.getElementById('minutes_date').value = '';
            document.getElementById('minutes_file').value = '';
        }

        function editMinutes(minutesId, title, date, description, content) {
            // Populate edit modal with existing data
            document.getElementById('edit_minutes_id').value = minutesId;
            document.getElementById('edit_minutes_title').value = title;
            document.getElementById('edit_minutes_date').value = date;
            // Set form action dynamically
            document.getElementById('editMinutesForm').action = '/edit_meeting_minutes/' + minutesId;
            // Show edit modal
            document.getElementById('editMinutesModal').style.display = 'block';
        }

        function closeEditMinutesModal() {
            document.getElementById('editMinutesModal').style.display = 'none';
        }

        function viewMinutes(content, title) {
            // Create a modal to display the minutes content
            const modal = document.createElement('div');
            modal.style.cssText = 'position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);';
            modal.innerHTML = `
                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); width: 90%; max-width: 800px; max-height: 80vh; overflow-y: auto;">
                    <h3 style="margin-top: 0; color: #384839;">${title}</h3>
                    <div style="white-space: pre-wrap; line-height: 1.6; margin-bottom: 20px;">${content.replace(/\\n/g, '\n').replace(/\\'/g, '\'')}</div>
                    <button onclick="this.parentElement.parentElement.remove()" style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Close</button>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            updateButtonStates();
        });
    </script>
</body>
</html>