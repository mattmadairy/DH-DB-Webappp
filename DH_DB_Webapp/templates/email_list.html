<!DOCTYPE html>
<html>
<head>
    <title>Email List - Dug Hill Rod & Gun Club</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='Main_Logo-removebg-preview.png') }}">
    <style>
        .active-menu {
            background-color: rgb(255,255,0) !important;
        }
        .submenu {
            display: none;
            flex-direction: column;
            margin-left: 10px;
        }
        .submenu.active {
            display: flex;
        }
        .submenu a {
            width: 160px !important;
            font-size: 0.9em !important;
            padding: 8px 0 !important;
            margin-bottom: 6px !important;
        }
        .menu-toggle {
            cursor: pointer;
            user-select: none;
        }
    </style>
</head>
<body style="background-color:#384839; font-family:Arial, Helvetica, sans-serif;">
    <div style="display:flex; flex-direction:row;">
        <!-- Static Side Menu -->
        <div style="position:fixed; top:0; left:0; height:100vh; width:210px; background-color:#2c332b; display:flex; flex-direction:column; align-items:center; padding-top:120px; z-index:100; box-shadow:2px 0 8px rgba(0,0,0,0.08); overflow-y:auto;">
            <img src="{{ url_for('static', filename='Main_Logo-removebg-preview.png') }}" alt="Main Logo" style="height:143px; margin-top:-88px; margin-left:-8px; margin-bottom:34px;">
            <a href="{{ url_for('index') }}" class="{{ 'active-menu' if active_page == 'home' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:{{ 'rgb(255,255,0)' if active_page == 'home' else '#eaeaea' }}; color:#384839; text-decoration:none; font-weight:{{ 'bold' if active_page == 'home' else 'normal' }}; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">ğŸ  Home</a>
            <a href="javascript:void(0);" onclick="openModal('addMemberModal')" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:normal; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">â• Add Member</a>
            <a href="{{ url_for('recycle_bin') }}" class="{{ 'active-menu' if active_page == 'recycle_bin' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:{{ 'bold' if active_page == 'recycle_bin' else 'normal' }}; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">ğŸ—‘ï¸ Recycle Bin</a>
            
            <div class="menu-toggle" onclick="toggleSubmenu()" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:normal; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">
                ğŸ“Š Reports <span id="submenu-arrow">â–¼</span>
            </div>
            <div id="reports-submenu" class="submenu {% if active_page in ['dues_report', 'work_hours_report', 'meeting_attendance_report', 'kiosk_report'] %}active{% endif %}">
                <a href="{{ url_for('dues_report') }}" class="{{ 'active-menu' if active_page == 'dues_report' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:{{ 'bold' if active_page == 'dues_report' else 'normal' }}; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">ğŸ’µ Dues</a>
                <a href="{{ url_for('work_hours_report') }}" class="{{ 'active-menu' if active_page == 'work_hours_report' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:{{ 'bold' if active_page == 'work_hours_report' else 'normal' }}; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">
                    <img src="{{ url_for('static', filename='icon_work_hours.svg') }}" alt="Work Hours" style="height:1em; vertical-align:middle; margin-right:6px;"> Work Hours
                </a>
                <a href="{{ url_for('meeting_attendance_report') }}" class="{{ 'active-menu' if active_page == 'meeting_attendance_report' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:{{ 'bold' if active_page == 'meeting_attendance_report' else 'normal' }}; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">
                    <img src="{{ url_for('static', filename='icon_attendance.svg') }}" alt="Attendance" style="height:1em; vertical-align:middle; margin-right:6px;"> Meeting Attendance
                </a>
                <a href="{{ url_for('kiosk_report') }}" class="{{ 'active-menu' if active_page == 'kiosk_report' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:{{ 'bold' if active_page == 'kiosk_report' else 'normal' }}; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">ğŸ“‹ Kiosk</a>
            </div>
            
            <a href="{{ url_for('committees') }}" class="{{ 'active-menu' if active_page == 'committees' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:{{ 'bold' if active_page == 'committees' else 'normal' }}; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">ğŸ‘¥ Committees</a>
            <a href="javascript:void(0);" onclick="generateEmailList()" class="{{ 'active-menu' if active_page == 'email_list' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:{{ 'bold' if active_page == 'email_list' else 'normal' }}; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">ğŸ“§ Email List</a>
            <a href="{{ url_for('kiosk') }}" target="_blank" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#eaeaea; color:#384839; text-decoration:none; font-weight:normal; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">ğŸ–¥ï¸ Kiosk</a>
            {% if current_user.is_admin_or_bdfl() %}
            <a href="{{ url_for('admin_users') }}" class="{{ 'active-menu' if active_page == 'admin_users' else '' }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:{{ '#5bc0de' if active_page != 'admin_users' else 'rgb(255,255,0)' }}; color:{{ '#ffffff' if active_page != 'admin_users' else '#000000' }}; text-decoration:none; font-weight:bold; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center; position:relative;">
                <span style="display:inline-block; width:100%; text-align:left;">
                    <span style="display: flex; align-items: center; width: 100%; justify-content: center; text-align: center;">
                        <span style="display:inline-block; vertical-align:middle;">ğŸ‘¤ Admin</span>
                    </span>
            </a>
            {% endif %}
            <a href="{{ url_for('logout') }}" style="width:170px; display:inline-block; padding:10px 0; margin-bottom:10px; border-radius:6px; border:1px solid #384839; background-color:#d9534f; color:#ffffff; text-decoration:none; font-weight:bold; font-size:1em; font-family:Arial, Helvetica, sans-serif; box-shadow:0 1px 2px rgba(0,0,0,0.04); text-align:center;">ğŸšª Logout</a>
            <div style="width:170px; margin-top:20px; padding:10px; border-top:1px solid #384839;">
                <div style="color:#f5f5f5; font-size:0.9em; line-height:1.6; text-align:left;">
                    <div style="margin-bottom:8px;"><strong>Life:</strong> {{ member_stats.life_members }}</div>
                    <div style="margin-bottom:8px;"><strong>Probationary, Associate, & Active:</strong> {{ member_stats.voting_members }}</div>
                    <div style="border-top:1px solid #555; padding-top:8px;"><strong>Total:</strong> {{ member_stats.total_members }}</div>
                </div>
            </div>
        </div>
        <!-- Main content area -->
        <div style="flex:1; margin-left:210px; display:flex; flex-direction:column; align-items:center; padding:20px;">
            <div style="text-align:center; margin-bottom:30px;">
                <h1 style="color:#f5f5f5; font-size:3em; margin-bottom:0.2em;">Dug Hill Rod & Gun Club</h1>
                <h1 style="color:#f5f5f5; font-size:3em; margin-top:0.2em;">Membership Database</h1>
                <h2 style="color:#f5f5f5; font-size:2.2em; margin-top:0; text-decoration:underline;">Email Distribution List</h2>
            </div>
            
            <div style="background-color:#f5f5f5; border-radius:8px; padding:32px; min-width:600px; max-width:800px; box-shadow:0 2px 8px rgba(0,0,0,0.08);">
                <h3 style="text-align:center; color:#384839; margin-top:0;">{{ member_type }} Members</h3>
                <p style="text-align:center; color:#384839; font-size:1.1em;">Total Email Addresses: <strong>{{ count }}</strong></p>
                
                <div style="margin:20px 0; text-align:center;">
                    <button onclick="copyToClipboard()" style="padding:10px 24px; border-radius:6px; border:1px solid #384839; background:#eaeaea; color:#384839; cursor:pointer; font-size:1.1em; font-weight:bold; margin-right:10px;">ğŸ“‹ Copy to Clipboard</button>
                    <button onclick="selectAll()" style="padding:10px 24px; border-radius:6px; border:1px solid #384839; background:#eaeaea; color:#384839; cursor:pointer; font-size:1.1em; font-weight:bold;">âœ“ Select All</button>
                </div>
                
                <textarea id="emailList" readonly style="width:100%; min-height:400px; padding:12px; font-family:monospace; font-size:0.95em; border:1px solid #ccc; border-radius:6px; resize:vertical; box-sizing:border-box;">{{ emails|join('; ') }}</textarea>
                
                <div style="margin-top:20px; text-align:center;">
                    <a href="{{ url_for('index') }}" style="display:inline-block; padding:10px 24px; border-radius:6px; border:1px solid #384839; background:#eaeaea; color:#384839; text-decoration:none; font-size:1.1em; font-weight:bold;">â† Back to Home</a>
                </div>
            </div>
        </div>
    </div>
    
    <script>
    function toggleSubmenu() {
        var submenu = document.getElementById('reports-submenu');
        var arrow = document.getElementById('submenu-arrow');
        submenu.classList.toggle('active');
        arrow.textContent = submenu.classList.contains('active') ? 'â–²' : 'â–¼';
    }
    
    function generateEmailList() {
        alert('Email list functionality would be here');
    }
    
    function copyToClipboard() {
        var textarea = document.getElementById('emailList');
        textarea.select();
        document.execCommand('copy');
        alert('Email list copied to clipboard!');
    }
    
    function selectAll() {
        var textarea = document.getElementById('emailList');
        textarea.select();
    }
    </script>
</body>
</html>
